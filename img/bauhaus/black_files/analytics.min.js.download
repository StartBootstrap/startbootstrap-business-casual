!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=t.NUMBER_OF_VIEWED_IMAGES="kw.images_storage",r=t.CURRENT_PAGE_URL="kw.current_page_url",a=t.MAX_VIEWED_IMAGES_PER_PAGE="kw.max_images_per_page",s=t.IMAGES_INFO="imagesInfo";t.ImagesTracker=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.localStorageHandler=t,this.window=n,this.document=n.document}return o(e,[{key:"getNumberImagesViewed",value:function(){var e=this.localStorageHandler.getStoredObject(s),t=e[i],n=e[r],o=this.document.URL,c=e[a],u=0,l=0;t&&(l=t),c&&(u=c);var f=this.getCurrentAmountOfImages();if(n===o){if(!(f>u))return l;l=l-u+f}else l+=f,e[r]=o;return e[i]=l,e[a]=f,this.localStorageHandler.storeObject(s,e),l}},{key:"getCurrentAmountOfImages",value:function(){var e=this.window,t=this.document.getElementsByTagName("img");return Array.prototype.slice.call(t).filter(function(e){return e.getBoundingClientRect().top<0}).filter(function(t){return t.height/e.screen.availHeight*100>10&&t.width/e.screen.availWidth*100>10}).length}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),o=e.getDate().toString();return t+(n[1]?n:"0"+n[0])+(o[1]?o:"0"+o[0])},i=t.firstLoadTime=new Date;t.todayStr=o(i),t.last30DaysDateStr=o(new Date((new Date).setDate(i.getDate()-30))),t.firstMonthDateStr=o(new Date(i.getFullYear(),i.getMonth(),1)),t.roundToTwo=function(e){return+(Math.round(e+"e+2")+"e-2")},t.sendCustomEvent=function(e,t,n){window.fbq&&window.fbq("trackSingleCustom",e,t,n)},t.sendEvent=function(e,t,n){window.fbq&&window.fbq("trackSingle",e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.LocalStorageHandler=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setLocalStorage(t)}return o(e,[{key:"setLocalStorage",value:function(e){var t,n,o;try{o=(new Date).toString(),(t=e.localStorage).setItem(o,o),n=t.getItem(o)===o,t.removeItem(o),n||(t=!1)}catch(e){}this.storage=t}},{key:"clearLocalStorage",value:function(e){this.storage&&this.storage.removeItem(e)}},{key:"storeObject",value:function(e,t){this.storage&&this.storage.setItem(e,JSON.stringify(t))}},{key:"getStoredObject",value:function(e){var t=this.storage&&this.storage.getItem(e);return t?JSON.parse(t):{}}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionTracker=t.SESSION_COOKIE_NAME=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(0);var r=t.SESSION_COOKIE_NAME="kw.session_ts";t.SessionTracker=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cookieHandler=t,this.localStorageHandler=n}return o(e,[{key:"initSessionData",value:function(e){this.cookieHandler.createCookie(r,e,1/48),this.setPageViewsPerSessionCount(1)}},{key:"setPageViewsPerSessionCount",value:function(e){this.cookieHandler.createCookie("kw.pv_session",e,1)}},{key:"getCurrentPageViewPerSession",value:function(){var e=this.cookieHandler.getCookie("kw.pv_session"),t=0;return e&&(t=parseInt(e)),t}},{key:"getAndUpdateSessionData",value:function(e){var t=e.getTime(),n=1,o=0,r=this.getExisitingSessionStart();r?(n=this.getCurrentPageViewPerSession()+1,o=Math.floor((t-r)/1e3),this.setPageViewsPerSessionCount(n)):(this.initSessionData(t),this.localStorageHandler.clearLocalStorage(i.IMAGES_INFO));return{pageViews:n,sessionLengthSeconds:o}}},{key:"getExisitingSessionStart",value:function(){var e=this.cookieHandler.getCookie(r),t=null;return e&&(t=parseInt(e)),t}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.CookieHandler=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.document=t,this.domain=n}return o(e,[{key:"getCookie",value:function(e){var t=("; "+this.document.cookie).split("; "+e+"=");if(2===t.length)return t.pop().split(";").shift()}},{key:"createCookie",value:function(e,t,n){var o,i;if(n){var r=new Date;r.setTime(r.getTime()+864e5*n),o="; expires="+r.toGMTString()}else o="";i=e+"="+t+o+"; path=/;",this.domain&&(i=i+" Domain="+this.domain),this.document.cookie=i}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=null,r=function(e,t){var n,r,a,s,c,u,l=(n=window.pageYOffset||document.documentElement.scrollTop,r=document.body,a=document.documentElement,s=window.innerHeight,c=Math.max(r.scrollHeight,r.offsetHeight,a.clientHeight,a.scrollHeight,a.offsetHeight),(0,o.roundToTwo)(Math.min(100,n/(c-s)*100))),f=null,d=l!==i,g=(0,o.roundToTwo)((new Date-o.firstLoadTime)/6e4);d&&!(g>30)&&(f={tsop:g,lop:l,noaip:(u=document.getElementsByTagName("iframe"),Array.prototype.slice.call(u).filter(function(e){return e.dataset.googleContainerId}).length),noims:t.getNumberImagesViewed()},(0,o.sendCustomEvent)(e,"KWCEPA",f),i=l)};t.default=function(e,t,n){var o=1e3*(t=t||30);setInterval(r.bind(null,e,n),o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initAdvancedPixel=t.sendAdvancedPageView=void 0;var o=n(1),i=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},r=null,a=null,s=null,c=function(){return a.getStoredObject("keyweeHistory")},u=function(e){a.storeObject("keyweeHistory",e)},l=function(e){var t,n,i=r.document.title,a=r.location.href.indexOf("kwp_4=")>0,s=(t=e||o.todayStr,c()[t]||{date:t});return s.categories||(s.categories={}),s.categories.general||(s.categories.general={articles_read:0,keywee_articles_read:0,time_spent:0,category:"general"}),(n=s.categories.general).last_visited_article!==i&&(n.articles_read++,a&&n.keywee_articles_read++,n.last_visited_article=i),function(e,t){var n=c();n[e]=t,u(n)}(e||o.todayStr,s),s},f=function(e,t){var n=c();return function(e,t,n){return Object.keys(e).filter(function(e){return e>=t&&(!n||e<=n)})}(n,e,t).map(function(e){return n[e]})};t.sendAdvancedPageView=function(e){var t;l(),t=function(){var e=f(o.last30DaysDateStr),t=f(o.firstMonthDateStr),n=f(o.todayStr,o.todayStr),r=s.getAndUpdateSessionData(new Date),a=function(e){return 1===e.length?i(e[0].categories):e.reduce(function(e,t){return e.concat(i(t.categories))},[])},c=function(e,t){return 1===e.length?e[0][t]:e.reduce(function(e,n){return e+n[t]},0)},u=a(e),l=a(t),d=c(a(n),"keywee_articles_read"),g={noad30:e.length,noadcm:t.length,nokart:d,pvps:r.pageViews,slensec:r.sessionLengthSeconds};return["articles_read","keywee_articles_read","time_spent"].forEach(function(e){var t=function(e){return e.split("_").map(function(e){return e[0]}).join("")}(e);[[t+"30d",u],[t+"cm",l]].forEach(function(t){var n=t[0],i=t[1],r=c(i,e);g[n]=(0,o.roundToTwo)(r)})}),g=function(e){return e.kar30d>0&&0===e.nokart?e.kru=1:e.kru=0,e}(g)}(),(0,o.sendCustomEvent)(e,"KWCEPV",t),(0,o.sendEvent)(e,"PageView")},t.initAdvancedPixel=function(e,t,n){var i,c,l;r=e,a=n,s=t,c=o.last30DaysDateStr,l={},o.firstMonthDateStr<c&&(c=o.firstMonthDateStr),i&&(c=i),f(c).forEach(function(e){l[e.date]=e}),u(l)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.DEFAULT_SNOWPLOW_SRC="//dc8xl0ndzn2cb.cloudfront.net/sp.js";t.SnowplowManager=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appendScriptToDom=function(e,t,n,o,i,r,a){e[i]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(i),e[i]=function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].q=e[i].q||[],r=t.createElement(n),a=t.getElementsByTagName(n)[0],r.async=1,r.src=o,a.parentNode.insertBefore(r,a))},this.initSnowplow=function(e,t,n,i,r,a){i=i||30,a=a||o,this.appendScriptToDom(e,e.document,"script",a,"snowplowKW"),e.snowplowKW("newTracker","cf","pixel.keywee.co",{appId:t,cookieDomain:n}),e.snowplowKW("setVisitorCookieTimeout",33696e3),r&&e.snowplowKW("enableActivityTracking",i,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t,n,o,i,r,a;t=window,n=document,o="script",t.fbq||(i=t.fbq=function(){i.callMethod?i.callMethod.apply(i,arguments):i.queue.push(arguments)},t._fbq||(t._fbq=i),i.push=i,i.loaded=!0,i.version="2.0",i.queue=[],(r=n.createElement(o)).async=!0,r.src="//connect.facebook.net/en_US/fbevents.js",(a=n.getElementsByTagName(o)[0]).parentNode.insertBefore(r,a)),window.fbq("init",e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var o=f(n(8)),i=n(7),r=n(6),a=f(n(5)),s=n(4),c=n(3),u=n(2),l=n(0);function f(e){return e&&e.__esModule?e:{default:e}}t.Tracker=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.snowplowManager=new i.SnowplowManager,this.setKeyweeAdId=function(e){var n=new RegExp("kwp_4=([^&#]*)","i").exec(t.location.href),o=n&&unescape(n[1])||"";""!==o&&this.cookieHandler.createCookie("keywee.kwp_4",o,30),t.snowplowKW&&t.snowplowKW("setUserIdFromCookie","keywee.kwp_4")},this.getConfig=function(e){var n=t.document.createElement("script");n.type="text/javascript",n.src="//cdn.keywee.co/config/"+e+".js",t.document.getElementsByTagName("head")[0].appendChild(n)},this.initiateTracking=function(){var e=this.config,n=this.testDomain||e.domain;this.cookieHandler=new s.CookieHandler(t.document,n),this.localStorageHandler=new u.LocalStorageHandler(t);var i=new l.ImagesTracker(this.localStorageHandler,t),f=new c.SessionTracker(this.cookieHandler,this.localStorageHandler);e.fbPixelId&&((0,o.default)(e.fbPixelId),(0,a.default)(e.fbPixelId,this.pixelPeriodTimeSec,i),(0,r.initAdvancedPixel)(t,f,this.localStorageHandler)),e.appId&&this.snowplowManager.initSnowplow(t,e.appId,n,this.pixelPeriodTimeSec,e.ping_activity,e.snowplow_src),this.setKeyweeAdId(n),this.sendPageView()},this.loadConfig=function(e){var t=e.in_eu||!1;this.config=e,t&&!this.trackEU||this.initiateTracking()},this.init=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pixelPeriodTimeSec=t.pixelPeriodTimeSec,this.testDomain=t.testDomain,void 0===t.trackEU?this.trackEU=!0:this.trackEU=t.trackEU,this.getConfig(e)},this.sendPageView=function(){t.snowplowKW&&t.snowplowKW("trackPageView"),this.config.fbPixelId&&(0,r.sendAdvancedPageView)(this.config.fbPixelId)},this.setCustomUrl=function(e){t.snowplowKW&&t.snowplowKW("setCustomUrl",e)},this.applyFunc=function(){try{var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),t=e.slice(1),n=e[0];"initialize"===n?this.init.apply(this,t):"sendPageView"===n?this.sendPageView.apply(this,t):"loadConfig"===n?this.loadConfig.apply(this,t):"setCustomUrl"===n&&this.setCustomUrl.apply(this,t)}catch(t){n=e[0],console.log("Error in keywee-analytics-tracker occurred trying to run the function "+n+": ",t)}}}},function(e,t,n){"use strict";var o=new(n(9).Tracker)(window);window.kwa&&window.kwa.q&&window.kwa.q.forEach(function(e){o.applyFunc.apply(o,e)});window.kwa=o.applyFunc.bind(o)}]);
//# sourceMappingURL=analytics.min.js.map